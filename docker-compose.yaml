version: "3.8"
services:
    app:
        build:
            context: .
        container_name: menu_service
        restart: always
        volumes:
            - ./src:/app
            - ./volumes/media:/media
            - ./volumes/static:/static
        command: bash -c "gunicorn --bind 0.0.0.0:8000 --timeout 600 --log-level debug --reload --max-requests 100 --workers 4 core.wsgi:application"

    nginx:
        container_name: menu_nginx
        image: nginx:1.21.1-alpine
        restart: always
        volumes:
            - ./nginx.conf:/etc/nginx/conf.d/default.conf
        ports:
            - 80:80
            - 443:80
        depends_on:
            - app
